{% extends "base.html" %}

{% block additional_js %}
    <script src="../static/js/lib/clipboard.min.js"></script>
{% endblock %}

{% block content %}
    <ul>
        <li><a href="/">Converter</a></li>
        <li><a href="/examples">Examples</a></li>
		<li><a href="/help">Help</a></li>
    </ul>

    <div class="andy_content">

		<p>
			This is the Python RPN Utility Functions program.<br>It contains all the required subroutines for running
			programs generated by the Python to RPN converter.
		</p>
		<p>
			<b>Normally you do not need this program</b> because any required utility subroutines are automatically embedded into your
			RPN.  However you can save memory by keeping your generated RPN small, and having it call the subroutines
			in this program instead. To do so, uncheck the <i>Auto include</i> checkbox on the main <a href="/">Converter</a> page.</p>
		<p><b>Warning:</b> New subroutines are added
			regularly, so make sure you delete this "PyLIB" program and paste the latest version into your
			calculator/Free42 regularly.</p>

		<div class="result-view">
			<!-- The buttons used to copy the text -->
			<button class="btn btn-primary" data-clipboard-text="{{ rpn }}" title="Copy RPN text as shown">Copy</button>
			<button class="btn btn-primary" data-clipboard-text="{{ rpn_free42 }}" title="Copy RPN text - ready to paste into Free42 calc (no comments, line numbers)">Copy for Free42</button>
		</div>
		<img src="static/calc_icon1.png" style="float: right;">
		<pre>{{ rpn }}</pre>


		<div class="result-view">
			<!-- The buttons used to copy the text -->
			<button class="btn btn-primary" data-clipboard-text="{{ rpn }}" title="Copy RPN text as shown">Copy</button>
			<button class="btn btn-primary" data-clipboard-text="{{ rpn_free42 }}" title="Copy RPN text - ready to paste into Free42 calc (no comments, line numbers)">Copy for Free42</button>
		</div>

		<h2>Advanced tips:</h2>
		<ul>
			<li>This program exposes numerous <b>global text labels</b>, allowing any program generated by the Python to RPN converter
				to call the required subroutine.
			</li>
			<li>You can play with and test the subroutines yourself, by the usual XEQ "subroutine name".
				For example "pGTE" takes two numbers on the stack and returns 1 or 0 depending on whether y >= x.
				Note: 1 means true and 0 means false.
			</li>
			<li>If you choose not to use this program of utility subroutines (the default) then these subroutines are
				'embedded' into generated RPN.  When embedded, all global text labels are converted into local
				numbered labels, so that the global namespace is not polluted.  Each generated RPN program thus becomes
				completely self contained, and there are no version dependencies on this common utility program.
				This is easier and probably what most people want, which is why <b>not</b> using this global utility
				program is the default.
			</li>

		</ul>

    </div>


<script>

        // Clipboard Copy
        $('[data-toggle="tooltip"]').tooltip()
        $('.btn').tooltip({
          trigger: 'click',
          placement: 'bottom'
        });

        function setTooltip(btn, message) {
          btn.tooltip('hide')
            .attr('data-original-title', message)
            .tooltip('show');
        }

        function hideTooltip(btn) {
          setTimeout(function() {
            btn.tooltip('hide');
          }, 1000);
        }

        // Clipboard Copy
        var clipboard = new Clipboard('.btn');
        clipboard.on('success', function(e) {
            // console.log(e);
            var btn = $(e.trigger);
            setTooltip(btn, 'Copied');
            hideTooltip(btn);
        });
        clipboard.on('error', function(e) {
            // console.log(e);
              setTooltip('Failed!');
              hideTooltip();
        });

</script>

{% endblock %}
